<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Data Science with Python - 12&nbsp; Data Reshaping and Enriching</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Assignment A.html" rel="next">
<link href="./Data aggregation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Reading data.html">Exploratory data analysis</a></li><li class="breadcrumb-item"><a href="./Data wrangling.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data Reshaping and Enriching</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./NU_Stat_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Data Science with Python</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Prerequisite: Python programming</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction to Python and Jupyter Notebooks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Python Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data structures</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Getting started: Coding environment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./venv_setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Setting up your environment with VS Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow_enhance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Enhancing Workflow in Jupyter Notebooks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Exploratory data analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reading data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reading Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumPy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">NumPy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Advanced_Data_Visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Advanced Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data cleaning and preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Cleaning and Preparation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data aggregation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data Grouping and Aggregation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data wrangling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data Reshaping and Enriching</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment A.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Assignment A</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment B.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Assignment B</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment C.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Assignment C</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment D.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Assignment D</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment E.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Assignment E</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Datasets &amp; Templates</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-reshaping" id="toc-data-reshaping" class="nav-link active" data-scroll-target="#data-reshaping"><span class="header-section-number">12.0.1</span> Data Reshaping</a>
  <ul>
  <li><a href="#why-data-reshaping-is-important" id="toc-why-data-reshaping-is-important" class="nav-link" data-scroll-target="#why-data-reshaping-is-important"><span class="header-section-number">12.0.1.1</span> Why Data Reshaping is Important:</a></li>
  <li><a href="#wide-vs.-long-data-format-in-data-reshaping" id="toc-wide-vs.-long-data-format-in-data-reshaping" class="nav-link" data-scroll-target="#wide-vs.-long-data-format-in-data-reshaping"><span class="header-section-number">12.0.1.2</span> Wide vs.&nbsp;Long Data Format in Data Reshaping</a></li>
  <li><a href="#pivoting-long-to-wide-using-pivot_table" id="toc-pivoting-long-to-wide-using-pivot_table" class="nav-link" data-scroll-target="#pivoting-long-to-wide-using-pivot_table"><span class="header-section-number">12.0.1.3</span> Pivoting “long” to “wide” using <code>pivot_table()</code></a></li>
  <li><a href="#melting-wide-to-long-using-melt" id="toc-melting-wide-to-long-using-melt" class="nav-link" data-scroll-target="#melting-wide-to-long-using-melt"><span class="header-section-number">12.0.1.4</span> Melting “wide” to “long” using <code>melt()</code></a></li>
  <li><a href="#stacking-and-unstacking-using-stack-and-unstack" id="toc-stacking-and-unstacking-using-stack-and-unstack" class="nav-link" data-scroll-target="#stacking-and-unstacking-using-stack-and-unstack"><span class="header-section-number">12.0.1.5</span> Stacking and Unstacking using <code>stack()</code> and <code>unstack()</code></a></li>
  <li><a href="#stacking-columns-to-rows-stack" id="toc-stacking-columns-to-rows-stack" class="nav-link" data-scroll-target="#stacking-columns-to-rows-stack"><span class="header-section-number">12.0.1.6</span> Stacking (Columns to Rows ): <code>stack()</code></a></li>
  <li><a href="#unstacking-rows-to-columns-unstack" id="toc-unstacking-rows-to-columns-unstack" class="nav-link" data-scroll-target="#unstacking-rows-to-columns-unstack"><span class="header-section-number">12.0.1.7</span> Unstacking (Rows to Columns) : <code>unstack()</code></a></li>
  <li><a href="#transpose" id="toc-transpose" class="nav-link" data-scroll-target="#transpose"><span class="header-section-number">12.0.1.8</span> Transpose</a></li>
  <li><a href="#summary-of-common-reshaping-functions" id="toc-summary-of-common-reshaping-functions" class="nav-link" data-scroll-target="#summary-of-common-reshaping-functions"><span class="header-section-number">12.0.1.9</span> Summary of Common Reshaping Functions:</a></li>
  <li><a href="#practical-use-cases" id="toc-practical-use-cases" class="nav-link" data-scroll-target="#practical-use-cases"><span class="header-section-number">12.0.1.10</span> Practical Use Cases:</a></li>
  <li><a href="#converting-from-multi-level-index-to-single-level-index-dataframe" id="toc-converting-from-multi-level-index-to-single-level-index-dataframe" class="nav-link" data-scroll-target="#converting-from-multi-level-index-to-single-level-index-dataframe"><span class="header-section-number">12.0.1.11</span> Converting from Multi-Level Index to Single-Level Index DataFrame</a></li>
  </ul></li>
  <li><a href="#data-enriching" id="toc-data-enriching" class="nav-link" data-scroll-target="#data-enriching"><span class="header-section-number">12.1</span> Data Enriching</a>
  <ul>
  <li><a href="#common-methods-for-data-enriching" id="toc-common-methods-for-data-enriching" class="nav-link" data-scroll-target="#common-methods-for-data-enriching"><span class="header-section-number">12.1.1</span> Common Methods for Data Enriching</a></li>
  <li><a href="#combining-based-on-common-keys-merge" id="toc-combining-based-on-common-keys-merge" class="nav-link" data-scroll-target="#combining-based-on-common-keys-merge"><span class="header-section-number">12.1.2</span> Combining based on common keys: <code>merge()</code></a>
  <ul class="collapse">
  <li><a href="#outer-join" id="toc-outer-join" class="nav-link" data-scroll-target="#outer-join"><span class="header-section-number">12.1.2.1</span> outer join</a></li>
  </ul></li>
  <li><a href="#combining-based-on-indices-join" id="toc-combining-based-on-indices-join" class="nav-link" data-scroll-target="#combining-based-on-indices-join"><span class="header-section-number">12.1.3</span> <strong>Combining Based on Indices: <code>join()</code></strong></a></li>
  <li><a href="#stacking-dataframes-vertically-or-horizontally-concat" id="toc-stacking-dataframes-vertically-or-horizontally-concat" class="nav-link" data-scroll-target="#stacking-dataframes-vertically-or-horizontally-concat"><span class="header-section-number">12.1.4</span> Stacking DataFrames vertically or horizontally: <code>concat()</code></a></li>
  <li><a href="#missing-values-after-data-enriching" id="toc-missing-values-after-data-enriching" class="nav-link" data-scroll-target="#missing-values-after-data-enriching"><span class="header-section-number">12.1.5</span> Missing values after data enriching</a></li>
  </ul></li>
  <li><a href="#independent-practice-1" id="toc-independent-practice-1" class="nav-link" data-scroll-target="#independent-practice-1"><span class="header-section-number">12.2</span> Independent Practice 1</a>
  <ul>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="header-section-number">12.2.1</span> </a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"><span class="header-section-number">12.2.2</span> </a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data Reshaping and Enriching</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this chapter, we will explore how to reshape and enrich data using pandas. Data reshaping and enriching are essential steps in data preprocessing because they help transform raw data into a more structured, useful, and meaningful format that can be effectively used for analysis or modeling.</p>
<div class="cell" data-execution_count="57">
<div class="cell-output cell-output-display">

<div style="display: flex; gap: 20px;">
    <img src="https://ucarecdn.com/fe16e27c-a341-4551-9b84-e0e56bb2d329/-/stretch/off/-/resize/1100x/-/format/webp/" width="400">
    <img src="https://pandas.pydata.org/docs/_images/merging_join_multi_df.png" width="500">
</div>
</div>
</div>
<section id="data-reshaping" class="level3" data-number="12.0.1">
<h3 data-number="12.0.1" class="anchored" data-anchor-id="data-reshaping"><span class="header-section-number">12.0.1</span> Data Reshaping</h3>
<p>Data reshaping involves altering the structure of the data to suit the requirements of the analysis or modeling process. This is often needed when the data is in a format that is difficult to analyze or when it needs to be organized in a specific way.</p>
<section id="why-data-reshaping-is-important" class="level4" data-number="12.0.1.1">
<h4 data-number="12.0.1.1" class="anchored" data-anchor-id="why-data-reshaping-is-important"><span class="header-section-number">12.0.1.1</span> Why Data Reshaping is Important:</h4>
<ul>
<li><p><strong>Improves Data Organization</strong>: Raw data may be in a long format, where each observation is recorded on a separate row, or it may be in a wide format, where the same variable is spread across multiple columns. Reshaping allows you to reorganize the data into a format that is more suitable for analysis, such as turning multiple columns into a single column (melting) or aggregating rows into summary statistics (pivoting).</p></li>
<li><p><strong>Facilitates Analysis</strong>: Some analysis techniques require specific data formats. For example, many machine learning algorithms require data in a matrix form, where each row represents a sample and each column represents a feature. Reshaping helps to convert data into this format.</p></li>
<li><p><strong>Simplifies Visualization</strong>: Visualizing data is easier when it is in the right shape. For instance, plotting categorical data across time is easier when the data is in a tidy format, rather than having multiple variables spread across columns.</p></li>
<li><p><strong>Efficient Grouping and Aggregation</strong>: In some cases, you may want to group data by certain categories or time periods, and reshaping can help aggregate data effectively for summarization.</p></li>
</ul>
</section>
<section id="wide-vs.-long-data-format-in-data-reshaping" class="level4" data-number="12.0.1.2">
<h4 data-number="12.0.1.2" class="anchored" data-anchor-id="wide-vs.-long-data-format-in-data-reshaping"><span class="header-section-number">12.0.1.2</span> Wide vs.&nbsp;Long Data Format in Data Reshaping</h4>
<ul>
<li><strong>Wide Format</strong>: Each variable in its own column; each row represents a unit, and data for multiple variables is spread across columns.</li>
<li><strong>Long Format</strong>: Variables are stacked into one column per variable, with additional columns used to indicate time, categories, or other distinctions, leading to a greater number of rows.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://ucarecdn.com/fe16e27c-a341-4551-9b84-e0e56bb2d329/-/stretch/off/-/resize/1100x/-/format/webp/.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Alt text</figcaption>
</figure>
</div>
<p>To reshape between these two formats, you can use pandas functions such as <code>pivot_table()</code>, <code>melt()</code>, <code>stack()</code>, and <code>unstack()</code>. Let’s next take a look at each of these methods one by one.</p>
<p>Throughout this section, we will continue using the <em>gdp_lifeExpectancy.csv</em> dataset. Let’s start by reading the CSV file into a pandas DataFrame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_data <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/gdp_lifeExpectancy.csv'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">lifeExp</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">gdpPercap</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Afghanistan</td>
<td>Asia</td>
<td>1952</td>
<td>28.801</td>
<td>8425333</td>
<td>779.445314</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Afghanistan</td>
<td>Asia</td>
<td>1957</td>
<td>30.332</td>
<td>9240934</td>
<td>820.853030</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Afghanistan</td>
<td>Asia</td>
<td>1962</td>
<td>31.997</td>
<td>10267083</td>
<td>853.100710</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Afghanistan</td>
<td>Asia</td>
<td>1967</td>
<td>34.020</td>
<td>11537966</td>
<td>836.197138</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Afghanistan</td>
<td>Asia</td>
<td>1972</td>
<td>36.088</td>
<td>13079460</td>
<td>739.981106</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="pivoting-long-to-wide-using-pivot_table" class="level4" data-number="12.0.1.3">
<h4 data-number="12.0.1.3" class="anchored" data-anchor-id="pivoting-long-to-wide-using-pivot_table"><span class="header-section-number">12.0.1.3</span> Pivoting “long” to “wide” using <code>pivot_table()</code></h4>
<p>In the last chapter, we learned that <code>pivot_table()</code> is a powerful tool for performing groupwise aggregation in a structured format. The <code>pivot_table()</code> function is used to reshape data by specifying columns for the index, columns, and values.</p>
<section id="pivoting-a-single-column" class="level5" data-number="12.0.1.3.1">
<h5 data-number="12.0.1.3.1" class="anchored" data-anchor-id="pivoting-a-single-column"><span class="header-section-number">12.0.1.3.1</span> Pivoting a single column</h5>
<p>Consider the life expectancy dataset. Let’s calculate the average life expectancy for each combination of country and year.</p>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_data_pivot <span class="op">=</span> gdp_lifeExp_data.pivot_table(index<span class="op">=</span>[<span class="st">'continent'</span>,<span class="st">'country'</span>], columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'lifeExp'</span>, aggfunc<span class="op">=</span><span class="st">'mean'</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_data_pivot.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">1952</th>
<th data-quarto-table-cell-role="th">1957</th>
<th data-quarto-table-cell-role="th">1962</th>
<th data-quarto-table-cell-role="th">1967</th>
<th data-quarto-table-cell-role="th">1972</th>
<th data-quarto-table-cell-role="th">1977</th>
<th data-quarto-table-cell-role="th">1982</th>
<th data-quarto-table-cell-role="th">1987</th>
<th data-quarto-table-cell-role="th">1992</th>
<th data-quarto-table-cell-role="th">1997</th>
<th data-quarto-table-cell-role="th">2002</th>
<th data-quarto-table-cell-role="th">2007</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Africa</td>
<td data-quarto-table-cell-role="th">Algeria</td>
<td>43.077</td>
<td>45.685</td>
<td>48.303</td>
<td>51.407</td>
<td>54.518</td>
<td>58.014</td>
<td>61.368</td>
<td>65.799</td>
<td>67.744</td>
<td>69.152</td>
<td>70.994</td>
<td>72.301</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Angola</td>
<td>30.015</td>
<td>31.999</td>
<td>34.000</td>
<td>35.985</td>
<td>37.928</td>
<td>39.483</td>
<td>39.942</td>
<td>39.906</td>
<td>40.647</td>
<td>40.963</td>
<td>41.003</td>
<td>42.731</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Benin</td>
<td>38.223</td>
<td>40.358</td>
<td>42.618</td>
<td>44.885</td>
<td>47.014</td>
<td>49.190</td>
<td>50.904</td>
<td>52.337</td>
<td>53.919</td>
<td>54.777</td>
<td>54.406</td>
<td>56.728</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Botswana</td>
<td>47.622</td>
<td>49.618</td>
<td>51.520</td>
<td>53.298</td>
<td>56.024</td>
<td>59.319</td>
<td>61.484</td>
<td>63.622</td>
<td>62.745</td>
<td>52.556</td>
<td>46.634</td>
<td>50.728</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Burkina Faso</td>
<td>31.975</td>
<td>34.906</td>
<td>37.814</td>
<td>40.697</td>
<td>43.591</td>
<td>46.137</td>
<td>48.122</td>
<td>49.557</td>
<td>50.260</td>
<td>50.324</td>
<td>50.650</td>
<td>52.295</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>Explanation</strong></p>
<ul>
<li><strong>values</strong>: Specifies the column to aggregate (e.g., <code>lifeExp</code> in our example).</li>
<li><strong>index</strong>: Groups by the rows based on the <code>continent</code> and <code>country</code> column.</li>
<li><strong>columns</strong>: Groups by the columns based on the <code>year</code> column.</li>
<li><strong>aggfunc</strong>: Uses <code>mean</code> to calculate the average life expectancy.</li>
</ul>
<p>With values of <code>year</code> as columns, it is easy to compare any metric for different years.</p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#visualizing the change in life expectancy of all countries in 2007 as compared to that in 1957, i.e., the overall change in life expectancy in 50 years. </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data <span class="op">=</span> gdp_lifeExp_data_pivot, x <span class="op">=</span> <span class="dv">1957</span>,y<span class="op">=</span><span class="dv">2007</span>,hue <span class="op">=</span> <span class="st">'continent'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>sns.lineplot(data <span class="op">=</span> gdp_lifeExp_data_pivot, x <span class="op">=</span> <span class="dv">1957</span>,y <span class="op">=</span> <span class="dv">1957</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Data wrangling_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Observe that for some African countries, the life expectancy has decreased after 50 years. It is worth investigating these countries to identify factors associated with the decrease.</p>
</section>
<section id="pivoting-multiple-columns" class="level5" data-number="12.0.1.3.2">
<h5 data-number="12.0.1.3.2" class="anchored" data-anchor-id="pivoting-multiple-columns"><span class="header-section-number">12.0.1.3.2</span> Pivoting multiple columns</h5>
<p>In the above transformation, we retained only <code>lifeExp</code> in the <em>‘wide’</em> dataset. Suppose, we are also interested in visualizing GDP per capita of countries in one year against another year. In that case, we must have <code>gdpPercap</code> in the <em>’wide</em>’-form data as well.</p>
<p>Let us create a dataset named as <code>data_wide_lifeExp_gdpPercap</code> that will contain both <code>lifeExp</code> and <code>gdpPercap</code> for each year in a separate column. We will specify the columns to pivot in the <em>values</em> argument of the <code>pivot()</code> function.</p>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data_wide_lifeExp_gdpPercap <span class="op">=</span> gdp_lifeExp_data.pivot_table(index <span class="op">=</span> [<span class="st">'continent'</span>,<span class="st">'country'</span>],columns <span class="op">=</span> <span class="st">'year'</span>,values <span class="op">=</span> [<span class="st">'lifeExp'</span>,<span class="st">'gdpPercap'</span>])</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data_wide_lifeExp_gdpPercap.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="10" data-quarto-table-cell-role="th" data-halign="left">gdpPercap</th>
<th data-quarto-table-cell-role="th">...</th>
<th colspan="10" data-quarto-table-cell-role="th" data-halign="left">lifeExp</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">1952</th>
<th data-quarto-table-cell-role="th">1957</th>
<th data-quarto-table-cell-role="th">1962</th>
<th data-quarto-table-cell-role="th">1967</th>
<th data-quarto-table-cell-role="th">1972</th>
<th data-quarto-table-cell-role="th">1977</th>
<th data-quarto-table-cell-role="th">1982</th>
<th data-quarto-table-cell-role="th">1987</th>
<th data-quarto-table-cell-role="th">1992</th>
<th data-quarto-table-cell-role="th">1997</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">1962</th>
<th data-quarto-table-cell-role="th">1967</th>
<th data-quarto-table-cell-role="th">1972</th>
<th data-quarto-table-cell-role="th">1977</th>
<th data-quarto-table-cell-role="th">1982</th>
<th data-quarto-table-cell-role="th">1987</th>
<th data-quarto-table-cell-role="th">1992</th>
<th data-quarto-table-cell-role="th">1997</th>
<th data-quarto-table-cell-role="th">2002</th>
<th data-quarto-table-cell-role="th">2007</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Africa</td>
<td data-quarto-table-cell-role="th">Algeria</td>
<td>2449.008185</td>
<td>3013.976023</td>
<td>2550.816880</td>
<td>3246.991771</td>
<td>4182.663766</td>
<td>4910.416756</td>
<td>5745.160213</td>
<td>5681.358539</td>
<td>5023.216647</td>
<td>4797.295051</td>
<td>...</td>
<td>48.303</td>
<td>51.407</td>
<td>54.518</td>
<td>58.014</td>
<td>61.368</td>
<td>65.799</td>
<td>67.744</td>
<td>69.152</td>
<td>70.994</td>
<td>72.301</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Angola</td>
<td>3520.610273</td>
<td>3827.940465</td>
<td>4269.276742</td>
<td>5522.776375</td>
<td>5473.288005</td>
<td>3008.647355</td>
<td>2756.953672</td>
<td>2430.208311</td>
<td>2627.845685</td>
<td>2277.140884</td>
<td>...</td>
<td>34.000</td>
<td>35.985</td>
<td>37.928</td>
<td>39.483</td>
<td>39.942</td>
<td>39.906</td>
<td>40.647</td>
<td>40.963</td>
<td>41.003</td>
<td>42.731</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Benin</td>
<td>1062.752200</td>
<td>959.601080</td>
<td>949.499064</td>
<td>1035.831411</td>
<td>1085.796879</td>
<td>1029.161251</td>
<td>1277.897616</td>
<td>1225.856010</td>
<td>1191.207681</td>
<td>1232.975292</td>
<td>...</td>
<td>42.618</td>
<td>44.885</td>
<td>47.014</td>
<td>49.190</td>
<td>50.904</td>
<td>52.337</td>
<td>53.919</td>
<td>54.777</td>
<td>54.406</td>
<td>56.728</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Botswana</td>
<td>851.241141</td>
<td>918.232535</td>
<td>983.653976</td>
<td>1214.709294</td>
<td>2263.611114</td>
<td>3214.857818</td>
<td>4551.142150</td>
<td>6205.883850</td>
<td>7954.111645</td>
<td>8647.142313</td>
<td>...</td>
<td>51.520</td>
<td>53.298</td>
<td>56.024</td>
<td>59.319</td>
<td>61.484</td>
<td>63.622</td>
<td>62.745</td>
<td>52.556</td>
<td>46.634</td>
<td>50.728</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Burkina Faso</td>
<td>543.255241</td>
<td>617.183465</td>
<td>722.512021</td>
<td>794.826560</td>
<td>854.735976</td>
<td>743.387037</td>
<td>807.198586</td>
<td>912.063142</td>
<td>931.752773</td>
<td>946.294962</td>
<td>...</td>
<td>37.814</td>
<td>40.697</td>
<td>43.591</td>
<td>46.137</td>
<td>48.122</td>
<td>49.557</td>
<td>50.260</td>
<td>50.324</td>
<td>50.650</td>
<td>52.295</td>
</tr>
</tbody>
</table>

<p>5 rows × 24 columns</p>
</div>
</div>
</div>
<p>The metric for each year is now in a separate column, and can be visualized directly. Note that re-arranging the dataset from the <em>‘long’</em>-form to <em>‘wide-form’</em> leads to hierarchical indexing of columns when multiple <em>‘values’</em> need to be re-arranged. In this case, the multiple <em>‘values’</em> that need to be re-arranged are <code>lifeExp</code> and <code>gdpPercap</code>.</p>
<p><strong>Common Aggregation Functions in <code>pivot_table()</code></strong></p>
<p>You can use various aggregation functions within <code>pivot_table()</code> to summarize data:</p>
<ul>
<li><strong><code>mean</code></strong> – Calculates the average of values within each group.</li>
<li><strong><code>sum</code></strong> – Computes the total of values within each group.</li>
<li><strong><code>count</code></strong> – Counts the number of non-null entries within each group.</li>
<li><strong><code>min</code></strong> and <strong><code>max</code></strong> – Finds the minimum and maximum values within each group.</li>
</ul>
<p>We can also define our own custom aggregation function and pass it to the <code>aggfunc</code> parameter of the <code>pivot_table()</code> function</p>
<p><strong>For Example:</strong> Find the <span class="math inline">\(90^{th}\)</span> percentile of life expectancy for each country and year combination</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pd.pivot_table(data <span class="op">=</span> gdp_lifeExp_data, values <span class="op">=</span> <span class="st">'lifeExp'</span>,index <span class="op">=</span> <span class="st">'country'</span>, columns <span class="op">=</span><span class="st">'year'</span>,aggfunc <span class="op">=</span> <span class="kw">lambda</span> x:np.percentile(x,<span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">1952</th>
<th data-quarto-table-cell-role="th">1957</th>
<th data-quarto-table-cell-role="th">1962</th>
<th data-quarto-table-cell-role="th">1967</th>
<th data-quarto-table-cell-role="th">1972</th>
<th data-quarto-table-cell-role="th">1977</th>
<th data-quarto-table-cell-role="th">1982</th>
<th data-quarto-table-cell-role="th">1987</th>
<th data-quarto-table-cell-role="th">1992</th>
<th data-quarto-table-cell-role="th">1997</th>
<th data-quarto-table-cell-role="th">2002</th>
<th data-quarto-table-cell-role="th">2007</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Afghanistan</td>
<td>28.801</td>
<td>30.332</td>
<td>31.997</td>
<td>34.020</td>
<td>36.088</td>
<td>38.438</td>
<td>39.854</td>
<td>40.822</td>
<td>41.674</td>
<td>41.763</td>
<td>42.129</td>
<td>43.828</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Albania</td>
<td>55.230</td>
<td>59.280</td>
<td>64.820</td>
<td>66.220</td>
<td>67.690</td>
<td>68.930</td>
<td>70.420</td>
<td>72.000</td>
<td>71.581</td>
<td>72.950</td>
<td>75.651</td>
<td>76.423</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Algeria</td>
<td>43.077</td>
<td>45.685</td>
<td>48.303</td>
<td>51.407</td>
<td>54.518</td>
<td>58.014</td>
<td>61.368</td>
<td>65.799</td>
<td>67.744</td>
<td>69.152</td>
<td>70.994</td>
<td>72.301</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Angola</td>
<td>30.015</td>
<td>31.999</td>
<td>34.000</td>
<td>35.985</td>
<td>37.928</td>
<td>39.483</td>
<td>39.942</td>
<td>39.906</td>
<td>40.647</td>
<td>40.963</td>
<td>41.003</td>
<td>42.731</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Argentina</td>
<td>62.485</td>
<td>64.399</td>
<td>65.142</td>
<td>65.634</td>
<td>67.065</td>
<td>68.481</td>
<td>69.942</td>
<td>70.774</td>
<td>71.868</td>
<td>73.275</td>
<td>74.340</td>
<td>75.320</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Vietnam</td>
<td>40.412</td>
<td>42.887</td>
<td>45.363</td>
<td>47.838</td>
<td>50.254</td>
<td>55.764</td>
<td>58.816</td>
<td>62.820</td>
<td>67.662</td>
<td>70.672</td>
<td>73.017</td>
<td>74.249</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">West Bank and Gaza</td>
<td>43.160</td>
<td>45.671</td>
<td>48.127</td>
<td>51.631</td>
<td>56.532</td>
<td>60.765</td>
<td>64.406</td>
<td>67.046</td>
<td>69.718</td>
<td>71.096</td>
<td>72.370</td>
<td>73.422</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Yemen, Rep.</td>
<td>32.548</td>
<td>33.970</td>
<td>35.180</td>
<td>36.984</td>
<td>39.848</td>
<td>44.175</td>
<td>49.113</td>
<td>52.922</td>
<td>55.599</td>
<td>58.020</td>
<td>60.308</td>
<td>62.698</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Zambia</td>
<td>42.038</td>
<td>44.077</td>
<td>46.023</td>
<td>47.768</td>
<td>50.107</td>
<td>51.386</td>
<td>51.821</td>
<td>50.821</td>
<td>46.100</td>
<td>40.238</td>
<td>39.193</td>
<td>42.384</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Zimbabwe</td>
<td>48.451</td>
<td>50.469</td>
<td>52.358</td>
<td>53.995</td>
<td>55.635</td>
<td>57.674</td>
<td>60.363</td>
<td>62.351</td>
<td>60.377</td>
<td>46.809</td>
<td>39.989</td>
<td>43.487</td>
</tr>
</tbody>
</table>

<p>142 rows × 12 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="melting-wide-to-long-using-melt" class="level4" data-number="12.0.1.4">
<h4 data-number="12.0.1.4" class="anchored" data-anchor-id="melting-wide-to-long-using-melt"><span class="header-section-number">12.0.1.4</span> Melting “wide” to “long” using <code>melt()</code></h4>
<p>Melting is the <strong>inverse</strong> of pivoting. It transforms columns into rows. The <code>melt()</code> function is used when you want to unpivot a DataFrame, turning multiple columns into rows.</p>
<p>Let’s first consider <em>gdp_lifeExp_data_pivot</em> created in the previous section</p>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_data_pivot.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">1952</th>
<th data-quarto-table-cell-role="th">1957</th>
<th data-quarto-table-cell-role="th">1962</th>
<th data-quarto-table-cell-role="th">1967</th>
<th data-quarto-table-cell-role="th">1972</th>
<th data-quarto-table-cell-role="th">1977</th>
<th data-quarto-table-cell-role="th">1982</th>
<th data-quarto-table-cell-role="th">1987</th>
<th data-quarto-table-cell-role="th">1992</th>
<th data-quarto-table-cell-role="th">1997</th>
<th data-quarto-table-cell-role="th">2002</th>
<th data-quarto-table-cell-role="th">2007</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Africa</td>
<td data-quarto-table-cell-role="th">Algeria</td>
<td>43.077</td>
<td>45.685</td>
<td>48.303</td>
<td>51.407</td>
<td>54.518</td>
<td>58.014</td>
<td>61.368</td>
<td>65.799</td>
<td>67.744</td>
<td>69.152</td>
<td>70.994</td>
<td>72.301</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Angola</td>
<td>30.015</td>
<td>31.999</td>
<td>34.000</td>
<td>35.985</td>
<td>37.928</td>
<td>39.483</td>
<td>39.942</td>
<td>39.906</td>
<td>40.647</td>
<td>40.963</td>
<td>41.003</td>
<td>42.731</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Benin</td>
<td>38.223</td>
<td>40.358</td>
<td>42.618</td>
<td>44.885</td>
<td>47.014</td>
<td>49.190</td>
<td>50.904</td>
<td>52.337</td>
<td>53.919</td>
<td>54.777</td>
<td>54.406</td>
<td>56.728</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Botswana</td>
<td>47.622</td>
<td>49.618</td>
<td>51.520</td>
<td>53.298</td>
<td>56.024</td>
<td>59.319</td>
<td>61.484</td>
<td>63.622</td>
<td>62.745</td>
<td>52.556</td>
<td>46.634</td>
<td>50.728</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Burkina Faso</td>
<td>31.975</td>
<td>34.906</td>
<td>37.814</td>
<td>40.697</td>
<td>43.591</td>
<td>46.137</td>
<td>48.122</td>
<td>49.557</td>
<td>50.260</td>
<td>50.324</td>
<td>50.650</td>
<td>52.295</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_data_pivot.melt(value_name<span class="op">=</span><span class="st">'lifeExp'</span>, var_name<span class="op">=</span><span class="st">'year'</span>, ignore_index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">lifeExp</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Africa</td>
<td data-quarto-table-cell-role="th">Algeria</td>
<td>1952</td>
<td>43.077</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Angola</td>
<td>1952</td>
<td>30.015</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Benin</td>
<td>1952</td>
<td>38.223</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Botswana</td>
<td>1952</td>
<td>47.622</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Burkina Faso</td>
<td>1952</td>
<td>31.975</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">Europe</td>
<td data-quarto-table-cell-role="th">Switzerland</td>
<td>2007</td>
<td>81.701</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Turkey</td>
<td>2007</td>
<td>71.777</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">United Kingdom</td>
<td>2007</td>
<td>79.425</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Oceania</td>
<td data-quarto-table-cell-role="th">Australia</td>
<td>2007</td>
<td>81.235</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">New Zealand</td>
<td>2007</td>
<td>80.204</td>
</tr>
</tbody>
</table>

<p>1704 rows × 2 columns</p>
</div>
</div>
</div>
<p>With the above DataFrame, we can visualize the mean life expectancy against year separately for each country in each continent.</p>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data_wide_lifeExp_gdpPercap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="10" data-quarto-table-cell-role="th" data-halign="left">gdpPercap</th>
<th data-quarto-table-cell-role="th">...</th>
<th colspan="10" data-quarto-table-cell-role="th" data-halign="left">lifeExp</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">1952</th>
<th data-quarto-table-cell-role="th">1957</th>
<th data-quarto-table-cell-role="th">1962</th>
<th data-quarto-table-cell-role="th">1967</th>
<th data-quarto-table-cell-role="th">1972</th>
<th data-quarto-table-cell-role="th">1977</th>
<th data-quarto-table-cell-role="th">1982</th>
<th data-quarto-table-cell-role="th">1987</th>
<th data-quarto-table-cell-role="th">1992</th>
<th data-quarto-table-cell-role="th">1997</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">1962</th>
<th data-quarto-table-cell-role="th">1967</th>
<th data-quarto-table-cell-role="th">1972</th>
<th data-quarto-table-cell-role="th">1977</th>
<th data-quarto-table-cell-role="th">1982</th>
<th data-quarto-table-cell-role="th">1987</th>
<th data-quarto-table-cell-role="th">1992</th>
<th data-quarto-table-cell-role="th">1997</th>
<th data-quarto-table-cell-role="th">2002</th>
<th data-quarto-table-cell-role="th">2007</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Africa</td>
<td data-quarto-table-cell-role="th">Algeria</td>
<td>2449.008185</td>
<td>3013.976023</td>
<td>2550.816880</td>
<td>3246.991771</td>
<td>4182.663766</td>
<td>4910.416756</td>
<td>5745.160213</td>
<td>5681.358539</td>
<td>5023.216647</td>
<td>4797.295051</td>
<td>...</td>
<td>48.303</td>
<td>51.407</td>
<td>54.518</td>
<td>58.014</td>
<td>61.368</td>
<td>65.799</td>
<td>67.744</td>
<td>69.152</td>
<td>70.994</td>
<td>72.301</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Angola</td>
<td>3520.610273</td>
<td>3827.940465</td>
<td>4269.276742</td>
<td>5522.776375</td>
<td>5473.288005</td>
<td>3008.647355</td>
<td>2756.953672</td>
<td>2430.208311</td>
<td>2627.845685</td>
<td>2277.140884</td>
<td>...</td>
<td>34.000</td>
<td>35.985</td>
<td>37.928</td>
<td>39.483</td>
<td>39.942</td>
<td>39.906</td>
<td>40.647</td>
<td>40.963</td>
<td>41.003</td>
<td>42.731</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Benin</td>
<td>1062.752200</td>
<td>959.601080</td>
<td>949.499064</td>
<td>1035.831411</td>
<td>1085.796879</td>
<td>1029.161251</td>
<td>1277.897616</td>
<td>1225.856010</td>
<td>1191.207681</td>
<td>1232.975292</td>
<td>...</td>
<td>42.618</td>
<td>44.885</td>
<td>47.014</td>
<td>49.190</td>
<td>50.904</td>
<td>52.337</td>
<td>53.919</td>
<td>54.777</td>
<td>54.406</td>
<td>56.728</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Botswana</td>
<td>851.241141</td>
<td>918.232535</td>
<td>983.653976</td>
<td>1214.709294</td>
<td>2263.611114</td>
<td>3214.857818</td>
<td>4551.142150</td>
<td>6205.883850</td>
<td>7954.111645</td>
<td>8647.142313</td>
<td>...</td>
<td>51.520</td>
<td>53.298</td>
<td>56.024</td>
<td>59.319</td>
<td>61.484</td>
<td>63.622</td>
<td>62.745</td>
<td>52.556</td>
<td>46.634</td>
<td>50.728</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Burkina Faso</td>
<td>543.255241</td>
<td>617.183465</td>
<td>722.512021</td>
<td>794.826560</td>
<td>854.735976</td>
<td>743.387037</td>
<td>807.198586</td>
<td>912.063142</td>
<td>931.752773</td>
<td>946.294962</td>
<td>...</td>
<td>37.814</td>
<td>40.697</td>
<td>43.591</td>
<td>46.137</td>
<td>48.122</td>
<td>49.557</td>
<td>50.260</td>
<td>50.324</td>
<td>50.650</td>
<td>52.295</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">Europe</td>
<td data-quarto-table-cell-role="th">Switzerland</td>
<td>14734.232750</td>
<td>17909.489730</td>
<td>20431.092700</td>
<td>22966.144320</td>
<td>27195.113040</td>
<td>26982.290520</td>
<td>28397.715120</td>
<td>30281.704590</td>
<td>31871.530300</td>
<td>32135.323010</td>
<td>...</td>
<td>71.320</td>
<td>72.770</td>
<td>73.780</td>
<td>75.390</td>
<td>76.210</td>
<td>77.410</td>
<td>78.030</td>
<td>79.370</td>
<td>80.620</td>
<td>81.701</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Turkey</td>
<td>1969.100980</td>
<td>2218.754257</td>
<td>2322.869908</td>
<td>2826.356387</td>
<td>3450.696380</td>
<td>4269.122326</td>
<td>4241.356344</td>
<td>5089.043686</td>
<td>5678.348271</td>
<td>6601.429915</td>
<td>...</td>
<td>52.098</td>
<td>54.336</td>
<td>57.005</td>
<td>59.507</td>
<td>61.036</td>
<td>63.108</td>
<td>66.146</td>
<td>68.835</td>
<td>70.845</td>
<td>71.777</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">United Kingdom</td>
<td>9979.508487</td>
<td>11283.177950</td>
<td>12477.177070</td>
<td>14142.850890</td>
<td>15895.116410</td>
<td>17428.748460</td>
<td>18232.424520</td>
<td>21664.787670</td>
<td>22705.092540</td>
<td>26074.531360</td>
<td>...</td>
<td>70.760</td>
<td>71.360</td>
<td>72.010</td>
<td>72.760</td>
<td>74.040</td>
<td>75.007</td>
<td>76.420</td>
<td>77.218</td>
<td>78.471</td>
<td>79.425</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Oceania</td>
<td data-quarto-table-cell-role="th">Australia</td>
<td>10039.595640</td>
<td>10949.649590</td>
<td>12217.226860</td>
<td>14526.124650</td>
<td>16788.629480</td>
<td>18334.197510</td>
<td>19477.009280</td>
<td>21888.889030</td>
<td>23424.766830</td>
<td>26997.936570</td>
<td>...</td>
<td>70.930</td>
<td>71.100</td>
<td>71.930</td>
<td>73.490</td>
<td>74.740</td>
<td>76.320</td>
<td>77.560</td>
<td>78.830</td>
<td>80.370</td>
<td>81.235</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">New Zealand</td>
<td>10556.575660</td>
<td>12247.395320</td>
<td>13175.678000</td>
<td>14463.918930</td>
<td>16046.037280</td>
<td>16233.717700</td>
<td>17632.410400</td>
<td>19007.191290</td>
<td>18363.324940</td>
<td>21050.413770</td>
<td>...</td>
<td>71.240</td>
<td>71.520</td>
<td>71.890</td>
<td>72.220</td>
<td>73.840</td>
<td>74.320</td>
<td>76.330</td>
<td>77.550</td>
<td>79.110</td>
<td>80.204</td>
</tr>
</tbody>
</table>

<p>142 rows × 24 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data_melt <span class="op">=</span> pd.melt(data_wide_lifeExp_gdpPercap.reset_index(), id_vars <span class="op">=</span> [<span class="st">'continent'</span>,<span class="st">'country'</span>], var_name <span class="op">=</span> [<span class="st">'Metric'</span>,<span class="st">'year'</span>])</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>data_melt.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>KeyError: "The following id_vars or value_vars are not present in the DataFrame: ['continent', 'country']"</code></pre>
</div>
</div>
</section>
<section id="stacking-and-unstacking-using-stack-and-unstack" class="level4" data-number="12.0.1.5">
<h4 data-number="12.0.1.5" class="anchored" data-anchor-id="stacking-and-unstacking-using-stack-and-unstack"><span class="header-section-number">12.0.1.5</span> Stacking and Unstacking using <code>stack()</code> and <code>unstack()</code></h4>
<p>Stacking and unstacking are powerful techniques used to reshape DataFrames by moving data between rows and columns. These operations are particularly useful when working with <strong>multi-level index</strong> or <strong>multi-level columns</strong>, where the data is structured in a hierarchical format.</p>
<ul>
<li><code>stack()</code>: Converts columns into rows, which means it “stacks” the data into a long format.</li>
<li><code>unstack()</code>: Converts rows into columns, reversing the effect of <code>stack()</code>.</li>
</ul>
<p>Let’s use the GDP per capita dataset and create a DataFrame with a multi-level index (e.g., continent, country) and multi-level columns (e.g., lifeExp , gdpPercap, and pop).</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the average and standard deviation of life expectancy, population, and GDP per capita for countries across the years.</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data <span class="op">=</span> gdp_lifeExp_data.groupby([<span class="st">'continent'</span>, <span class="st">'country'</span>])[[<span class="st">'lifeExp'</span>, <span class="st">'pop'</span>, <span class="st">'gdpPercap'</span>]].agg([<span class="st">'mean'</span>, <span class="st">'std'</span>])</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">lifeExp</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">pop</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">gdpPercap</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Africa</td>
<td data-quarto-table-cell-role="th">Algeria</td>
<td>59.030167</td>
<td>10.340069</td>
<td>1.987541e+07</td>
<td>8.613355e+06</td>
<td>4426.025973</td>
<td>1310.337656</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Angola</td>
<td>37.883500</td>
<td>4.005276</td>
<td>7.309390e+06</td>
<td>2.672281e+06</td>
<td>3607.100529</td>
<td>1165.900251</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Benin</td>
<td>48.779917</td>
<td>6.128681</td>
<td>4.017497e+06</td>
<td>2.105002e+06</td>
<td>1155.395107</td>
<td>159.741306</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Botswana</td>
<td>54.597500</td>
<td>5.929476</td>
<td>9.711862e+05</td>
<td>4.710965e+05</td>
<td>5031.503557</td>
<td>4178.136987</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Burkina Faso</td>
<td>44.694000</td>
<td>6.845792</td>
<td>7.548677e+06</td>
<td>3.247808e+06</td>
<td>843.990665</td>
<td>183.430087</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">Europe</td>
<td data-quarto-table-cell-role="th">Switzerland</td>
<td>75.565083</td>
<td>4.011572</td>
<td>6.384293e+06</td>
<td>8.582009e+05</td>
<td>27074.334405</td>
<td>6886.463308</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Turkey</td>
<td>59.696417</td>
<td>9.030591</td>
<td>4.590901e+07</td>
<td>1.667768e+07</td>
<td>4469.453380</td>
<td>2049.665102</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">United Kingdom</td>
<td>73.922583</td>
<td>3.378943</td>
<td>5.608780e+07</td>
<td>3.174339e+06</td>
<td>19380.472986</td>
<td>7388.189399</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Oceania</td>
<td data-quarto-table-cell-role="th">Australia</td>
<td>74.662917</td>
<td>4.147774</td>
<td>1.464931e+07</td>
<td>3.915203e+06</td>
<td>19980.595634</td>
<td>7815.405220</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">New Zealand</td>
<td>73.989500</td>
<td>3.559724</td>
<td>3.100032e+06</td>
<td>6.547108e+05</td>
<td>17262.622813</td>
<td>4409.009167</td>
</tr>
</tbody>
</table>

<p>142 rows × 6 columns</p>
</div>
</div>
</div>
<p>The resulting DataFrame has two levels of index and two levels of columns, as shown below:</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check the level of row and column index</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.index.nlevels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>2</code></pre>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.columns.nlevels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>2</code></pre>
</div>
</div>
<p>if you want to see the data along with the index and columns (in a more accessible way), you can directly print the <code>.index</code> and <code>.columns</code> attributes.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>MultiIndex([( 'Africa',                  'Algeria'),
            ( 'Africa',                   'Angola'),
            ( 'Africa',                    'Benin'),
            ( 'Africa',                 'Botswana'),
            ( 'Africa',             'Burkina Faso'),
            ( 'Africa',                  'Burundi'),
            ( 'Africa',                 'Cameroon'),
            ( 'Africa', 'Central African Republic'),
            ( 'Africa',                     'Chad'),
            ( 'Africa',                  'Comoros'),
            ...
            ( 'Europe',                   'Serbia'),
            ( 'Europe',          'Slovak Republic'),
            ( 'Europe',                 'Slovenia'),
            ( 'Europe',                    'Spain'),
            ( 'Europe',                   'Sweden'),
            ( 'Europe',              'Switzerland'),
            ( 'Europe',                   'Turkey'),
            ( 'Europe',           'United Kingdom'),
            ('Oceania',                'Australia'),
            ('Oceania',              'New Zealand')],
           names=['continent', 'country'], length=142)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>MultiIndex([(  'lifeExp', 'mean'),
            (  'lifeExp',  'std'),
            (      'pop', 'mean'),
            (      'pop',  'std'),
            ('gdpPercap', 'mean'),
            ('gdpPercap',  'std')],
           )</code></pre>
</div>
</div>
<p>As seen, <strong>the index and columns each contain tuples</strong>. This is the reason that when performing data subsetting on a DataFrame with multi-level index and columns, you need to supply a tuple to specify the exact location of the data.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.loc[(<span class="st">'Americas'</span>, <span class="st">'United States'</span>), (<span class="st">'lifeExp'</span>, <span class="st">'mean'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>73.4785</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.columns.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>array([('lifeExp', 'mean'), ('lifeExp', 'std'), ('pop', 'mean'),
       ('pop', 'std'), ('gdpPercap', 'mean'), ('gdpPercap', 'std')],
      dtype=object)</code></pre>
</div>
</div>
<section id="understanding-the-level-in-multi-level-index-and-columns" class="level5" data-number="12.0.1.5.1">
<h5 data-number="12.0.1.5.1" class="anchored" data-anchor-id="understanding-the-level-in-multi-level-index-and-columns"><span class="header-section-number">12.0.1.5.1</span> Understanding the <code>level</code> in multi-level index and columns</h5>
<p>The <code>gdp_lifeExp_multilevel_data</code> dataframe have two levels of index and two level of columns, You can reference these levels in various operations, such as grouping, subsetting, or performing aggregations. The <code>level</code> parameter helps identify which part of the multi-level structure you’re working with.</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.index.get_level_values(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>Index(['Africa', 'Africa', 'Africa', 'Africa', 'Africa', 'Africa', 'Africa',
       'Africa', 'Africa', 'Africa',
       ...
       'Europe', 'Europe', 'Europe', 'Europe', 'Europe', 'Europe', 'Europe',
       'Europe', 'Oceania', 'Oceania'],
      dtype='object', name='continent', length=142)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.index.get_level_values(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.columns.get_level_values(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>Index(['lifeExp', 'lifeExp', 'pop', 'pop', 'gdpPercap', 'gdpPercap'], dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.columns.get_level_values(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>Index(['mean', 'std', 'mean', 'std', 'mean', 'std'], dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.columns.get_level_values(<span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>Index(['mean', 'std', 'mean', 'std', 'mean', 'std'], dtype='object')</code></pre>
</div>
</div>
<p>As seen above, the outermost level corresponds to <code>level=0</code>, and it increases as we move inward to the inner levels. The innermost level can be referred to as <code>-1</code>.</p>
<p>Now, let’s use the level number in the <code>droplevel()</code> method to see how it works. The syntax for this method is as follows:</p>
<p><code>DataFrame.droplevel(level, axis=0)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop the first level of row index</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.droplevel(<span class="dv">0</span>, axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">lifeExp</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">pop</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">gdpPercap</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Algeria</td>
<td>59.030167</td>
<td>10.340069</td>
<td>1.987541e+07</td>
<td>8.613355e+06</td>
<td>4426.025973</td>
<td>1310.337656</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Angola</td>
<td>37.883500</td>
<td>4.005276</td>
<td>7.309390e+06</td>
<td>2.672281e+06</td>
<td>3607.100529</td>
<td>1165.900251</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Benin</td>
<td>48.779917</td>
<td>6.128681</td>
<td>4.017497e+06</td>
<td>2.105002e+06</td>
<td>1155.395107</td>
<td>159.741306</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Botswana</td>
<td>54.597500</td>
<td>5.929476</td>
<td>9.711862e+05</td>
<td>4.710965e+05</td>
<td>5031.503557</td>
<td>4178.136987</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Burkina Faso</td>
<td>44.694000</td>
<td>6.845792</td>
<td>7.548677e+06</td>
<td>3.247808e+06</td>
<td>843.990665</td>
<td>183.430087</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Switzerland</td>
<td>75.565083</td>
<td>4.011572</td>
<td>6.384293e+06</td>
<td>8.582009e+05</td>
<td>27074.334405</td>
<td>6886.463308</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Turkey</td>
<td>59.696417</td>
<td>9.030591</td>
<td>4.590901e+07</td>
<td>1.667768e+07</td>
<td>4469.453380</td>
<td>2049.665102</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">United Kingdom</td>
<td>73.922583</td>
<td>3.378943</td>
<td>5.608780e+07</td>
<td>3.174339e+06</td>
<td>19380.472986</td>
<td>7388.189399</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Australia</td>
<td>74.662917</td>
<td>4.147774</td>
<td>1.464931e+07</td>
<td>3.915203e+06</td>
<td>19980.595634</td>
<td>7815.405220</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">New Zealand</td>
<td>73.989500</td>
<td>3.559724</td>
<td>3.100032e+06</td>
<td>6.547108e+05</td>
<td>17262.622813</td>
<td>4409.009167</td>
</tr>
</tbody>
</table>

<p>142 rows × 6 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop the first level of column index</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.droplevel(<span class="dv">0</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Africa</td>
<td data-quarto-table-cell-role="th">Algeria</td>
<td>59.030167</td>
<td>10.340069</td>
<td>1.987541e+07</td>
<td>8.613355e+06</td>
<td>4426.025973</td>
<td>1310.337656</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Angola</td>
<td>37.883500</td>
<td>4.005276</td>
<td>7.309390e+06</td>
<td>2.672281e+06</td>
<td>3607.100529</td>
<td>1165.900251</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Benin</td>
<td>48.779917</td>
<td>6.128681</td>
<td>4.017497e+06</td>
<td>2.105002e+06</td>
<td>1155.395107</td>
<td>159.741306</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Botswana</td>
<td>54.597500</td>
<td>5.929476</td>
<td>9.711862e+05</td>
<td>4.710965e+05</td>
<td>5031.503557</td>
<td>4178.136987</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Burkina Faso</td>
<td>44.694000</td>
<td>6.845792</td>
<td>7.548677e+06</td>
<td>3.247808e+06</td>
<td>843.990665</td>
<td>183.430087</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">Europe</td>
<td data-quarto-table-cell-role="th">Switzerland</td>
<td>75.565083</td>
<td>4.011572</td>
<td>6.384293e+06</td>
<td>8.582009e+05</td>
<td>27074.334405</td>
<td>6886.463308</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Turkey</td>
<td>59.696417</td>
<td>9.030591</td>
<td>4.590901e+07</td>
<td>1.667768e+07</td>
<td>4469.453380</td>
<td>2049.665102</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">United Kingdom</td>
<td>73.922583</td>
<td>3.378943</td>
<td>5.608780e+07</td>
<td>3.174339e+06</td>
<td>19380.472986</td>
<td>7388.189399</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Oceania</td>
<td data-quarto-table-cell-role="th">Australia</td>
<td>74.662917</td>
<td>4.147774</td>
<td>1.464931e+07</td>
<td>3.915203e+06</td>
<td>19980.595634</td>
<td>7815.405220</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">New Zealand</td>
<td>73.989500</td>
<td>3.559724</td>
<td>3.100032e+06</td>
<td>6.547108e+05</td>
<td>17262.622813</td>
<td>4409.009167</td>
</tr>
</tbody>
</table>

<p>142 rows × 6 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="stacking-columns-to-rows-stack" class="level4" data-number="12.0.1.6">
<h4 data-number="12.0.1.6" class="anchored" data-anchor-id="stacking-columns-to-rows-stack"><span class="header-section-number">12.0.1.6</span> Stacking (Columns to Rows ): <code>stack()</code></h4>
<p>The <code>stack()</code> function pivots the columns into rows. You can specify which level you want to stack using the <code>level</code> parameter. By default, it will stack the innermost level of the columns.</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.stack(future_stack<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">lifeExp</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">gdpPercap</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Africa</td>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Algeria</td>
<td data-quarto-table-cell-role="th">mean</td>
<td>59.030167</td>
<td>1.987541e+07</td>
<td>4426.025973</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>10.340069</td>
<td>8.613355e+06</td>
<td>1310.337656</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Angola</td>
<td data-quarto-table-cell-role="th">mean</td>
<td>37.883500</td>
<td>7.309390e+06</td>
<td>3607.100529</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>4.005276</td>
<td>2.672281e+06</td>
<td>1165.900251</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Benin</td>
<td data-quarto-table-cell-role="th">mean</td>
<td>48.779917</td>
<td>4.017497e+06</td>
<td>1155.395107</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Europe</td>
<td data-quarto-table-cell-role="th">United Kingdom</td>
<td data-quarto-table-cell-role="th">std</td>
<td>3.378943</td>
<td>3.174339e+06</td>
<td>7388.189399</td>
</tr>
<tr class="even">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">Oceania</td>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Australia</td>
<td data-quarto-table-cell-role="th">mean</td>
<td>74.662917</td>
<td>1.464931e+07</td>
<td>19980.595634</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>4.147774</td>
<td>3.915203e+06</td>
<td>7815.405220</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">New Zealand</td>
<td data-quarto-table-cell-role="th">mean</td>
<td>73.989500</td>
<td>3.100032e+06</td>
<td>17262.622813</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>3.559724</td>
<td>6.547108e+05</td>
<td>4409.009167</td>
</tr>
</tbody>
</table>

<p>284 rows × 3 columns</p>
</div>
</div>
</div>
<p>Let’s change the default setting by specifying the <code>level=0</code>(the outmost level)</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.stack(level<span class="op">=</span><span class="dv">0</span>, future_stack<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Africa</td>
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">Algeria</td>
<td data-quarto-table-cell-role="th">lifeExp</td>
<td>5.903017e+01</td>
<td>1.034007e+01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">pop</td>
<td>1.987541e+07</td>
<td>8.613355e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">gdpPercap</td>
<td>4.426026e+03</td>
<td>1.310338e+03</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Angola</td>
<td data-quarto-table-cell-role="th">lifeExp</td>
<td>3.788350e+01</td>
<td>4.005276e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">pop</td>
<td>7.309390e+06</td>
<td>2.672281e+06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Oceania</td>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Australia</td>
<td data-quarto-table-cell-role="th">pop</td>
<td>1.464931e+07</td>
<td>3.915203e+06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">gdpPercap</td>
<td>1.998060e+04</td>
<td>7.815405e+03</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">New Zealand</td>
<td data-quarto-table-cell-role="th">lifeExp</td>
<td>7.398950e+01</td>
<td>3.559724e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">pop</td>
<td>3.100032e+06</td>
<td>6.547108e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">gdpPercap</td>
<td>1.726262e+04</td>
<td>4.409009e+03</td>
</tr>
</tbody>
</table>

<p>426 rows × 2 columns</p>
</div>
</div>
</div>
</section>
<section id="unstacking-rows-to-columns-unstack" class="level4" data-number="12.0.1.7">
<h4 data-number="12.0.1.7" class="anchored" data-anchor-id="unstacking-rows-to-columns-unstack"><span class="header-section-number">12.0.1.7</span> Unstacking (Rows to Columns) : <code>unstack()</code></h4>
<p>The <code>unstack()</code> function pivots the rows back into columns. By default, it will unstack the innermost level of the index.</p>
<p>Let’s reverse the prevous dataframe to its original shape using <code>unstack()</code>.</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.stack(level<span class="op">=</span><span class="dv">0</span>, future_stack<span class="op">=</span><span class="va">True</span>).unstack()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">mean</th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">std</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">lifeExp</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">gdpPercap</th>
<th data-quarto-table-cell-role="th">lifeExp</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">gdpPercap</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Africa</td>
<td data-quarto-table-cell-role="th">Algeria</td>
<td>59.030167</td>
<td>1.987541e+07</td>
<td>4426.025973</td>
<td>10.340069</td>
<td>8.613355e+06</td>
<td>1310.337656</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Angola</td>
<td>37.883500</td>
<td>7.309390e+06</td>
<td>3607.100529</td>
<td>4.005276</td>
<td>2.672281e+06</td>
<td>1165.900251</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Benin</td>
<td>48.779917</td>
<td>4.017497e+06</td>
<td>1155.395107</td>
<td>6.128681</td>
<td>2.105002e+06</td>
<td>159.741306</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Botswana</td>
<td>54.597500</td>
<td>9.711862e+05</td>
<td>5031.503557</td>
<td>5.929476</td>
<td>4.710965e+05</td>
<td>4178.136987</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Burkina Faso</td>
<td>44.694000</td>
<td>7.548677e+06</td>
<td>843.990665</td>
<td>6.845792</td>
<td>3.247808e+06</td>
<td>183.430087</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">Europe</td>
<td data-quarto-table-cell-role="th">Switzerland</td>
<td>75.565083</td>
<td>6.384293e+06</td>
<td>27074.334405</td>
<td>4.011572</td>
<td>8.582009e+05</td>
<td>6886.463308</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Turkey</td>
<td>59.696417</td>
<td>4.590901e+07</td>
<td>4469.453380</td>
<td>9.030591</td>
<td>1.667768e+07</td>
<td>2049.665102</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">United Kingdom</td>
<td>73.922583</td>
<td>5.608780e+07</td>
<td>19380.472986</td>
<td>3.378943</td>
<td>3.174339e+06</td>
<td>7388.189399</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Oceania</td>
<td data-quarto-table-cell-role="th">Australia</td>
<td>74.662917</td>
<td>1.464931e+07</td>
<td>19980.595634</td>
<td>4.147774</td>
<td>3.915203e+06</td>
<td>7815.405220</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">New Zealand</td>
<td>73.989500</td>
<td>3.100032e+06</td>
<td>17262.622813</td>
<td>3.559724</td>
<td>6.547108e+05</td>
<td>4409.009167</td>
</tr>
</tbody>
</table>

<p>142 rows × 6 columns</p>
</div>
</div>
</div>
</section>
<section id="transpose" class="level4" data-number="12.0.1.8">
<h4 data-number="12.0.1.8" class="anchored" data-anchor-id="transpose"><span class="header-section-number">12.0.1.8</span> Transpose</h4>
<p>If you simply want to swap rows and columns, you can use the <code>.T</code> attribute.</p>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">continent</th>
<th colspan="10" data-quarto-table-cell-role="th" data-halign="left">Africa</th>
<th data-quarto-table-cell-role="th">...</th>
<th colspan="8" data-quarto-table-cell-role="th" data-halign="left">Europe</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Oceania</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">Algeria</th>
<th data-quarto-table-cell-role="th">Angola</th>
<th data-quarto-table-cell-role="th">Benin</th>
<th data-quarto-table-cell-role="th">Botswana</th>
<th data-quarto-table-cell-role="th">Burkina Faso</th>
<th data-quarto-table-cell-role="th">Burundi</th>
<th data-quarto-table-cell-role="th">Cameroon</th>
<th data-quarto-table-cell-role="th">Central African Republic</th>
<th data-quarto-table-cell-role="th">Chad</th>
<th data-quarto-table-cell-role="th">Comoros</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Serbia</th>
<th data-quarto-table-cell-role="th">Slovak Republic</th>
<th data-quarto-table-cell-role="th">Slovenia</th>
<th data-quarto-table-cell-role="th">Spain</th>
<th data-quarto-table-cell-role="th">Sweden</th>
<th data-quarto-table-cell-role="th">Switzerland</th>
<th data-quarto-table-cell-role="th">Turkey</th>
<th data-quarto-table-cell-role="th">United Kingdom</th>
<th data-quarto-table-cell-role="th">Australia</th>
<th data-quarto-table-cell-role="th">New Zealand</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">lifeExp</td>
<td data-quarto-table-cell-role="th">mean</td>
<td>5.903017e+01</td>
<td>3.788350e+01</td>
<td>4.877992e+01</td>
<td>54.597500</td>
<td>4.469400e+01</td>
<td>4.481733e+01</td>
<td>4.812850e+01</td>
<td>4.386692e+01</td>
<td>4.677358e+01</td>
<td>52.381750</td>
<td>...</td>
<td>6.855100e+01</td>
<td>7.069608e+01</td>
<td>7.160075e+01</td>
<td>7.420342e+01</td>
<td>7.617700e+01</td>
<td>7.556508e+01</td>
<td>5.969642e+01</td>
<td>7.392258e+01</td>
<td>7.466292e+01</td>
<td>7.398950e+01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>1.034007e+01</td>
<td>4.005276e+00</td>
<td>6.128681e+00</td>
<td>5.929476</td>
<td>6.845792e+00</td>
<td>3.174882e+00</td>
<td>5.467960e+00</td>
<td>4.720690e+00</td>
<td>4.887978e+00</td>
<td>8.132353</td>
<td>...</td>
<td>4.906736e+00</td>
<td>2.715787e+00</td>
<td>3.677979e+00</td>
<td>5.155859e+00</td>
<td>3.003990e+00</td>
<td>4.011572e+00</td>
<td>9.030591e+00</td>
<td>3.378943e+00</td>
<td>4.147774e+00</td>
<td>3.559724e+00</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">pop</td>
<td data-quarto-table-cell-role="th">mean</td>
<td>1.987541e+07</td>
<td>7.309390e+06</td>
<td>4.017497e+06</td>
<td>971186.166667</td>
<td>7.548677e+06</td>
<td>4.651608e+06</td>
<td>9.816648e+06</td>
<td>2.560963e+06</td>
<td>5.329256e+06</td>
<td>361683.916667</td>
<td>...</td>
<td>8.783887e+06</td>
<td>4.774507e+06</td>
<td>1.794381e+06</td>
<td>3.585180e+07</td>
<td>8.220029e+06</td>
<td>6.384293e+06</td>
<td>4.590901e+07</td>
<td>5.608780e+07</td>
<td>1.464931e+07</td>
<td>3.100032e+06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>8.613355e+06</td>
<td>2.672281e+06</td>
<td>2.105002e+06</td>
<td>471096.527435</td>
<td>3.247808e+06</td>
<td>1.874538e+06</td>
<td>4.363640e+06</td>
<td>1.072158e+06</td>
<td>2.464304e+06</td>
<td>182998.737990</td>
<td>...</td>
<td>1.192153e+06</td>
<td>6.425096e+05</td>
<td>2.022077e+05</td>
<td>4.323928e+06</td>
<td>6.365660e+05</td>
<td>8.582009e+05</td>
<td>1.667768e+07</td>
<td>3.174339e+06</td>
<td>3.915203e+06</td>
<td>6.547108e+05</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">gdpPercap</td>
<td data-quarto-table-cell-role="th">mean</td>
<td>4.426026e+03</td>
<td>3.607101e+03</td>
<td>1.155395e+03</td>
<td>5031.503557</td>
<td>8.439907e+02</td>
<td>4.716630e+02</td>
<td>1.774634e+03</td>
<td>9.587847e+02</td>
<td>1.165454e+03</td>
<td>1314.380339</td>
<td>...</td>
<td>9.305049e+03</td>
<td>1.041553e+04</td>
<td>1.407458e+04</td>
<td>1.402983e+04</td>
<td>1.994313e+04</td>
<td>2.707433e+04</td>
<td>4.469453e+03</td>
<td>1.938047e+04</td>
<td>1.998060e+04</td>
<td>1.726262e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>1.310338e+03</td>
<td>1.165900e+03</td>
<td>1.597413e+02</td>
<td>4178.136987</td>
<td>1.834301e+02</td>
<td>9.932972e+01</td>
<td>4.195899e+02</td>
<td>1.919529e+02</td>
<td>2.305481e+02</td>
<td>298.334389</td>
<td>...</td>
<td>3.829907e+03</td>
<td>3.650231e+03</td>
<td>6.470288e+03</td>
<td>8.046635e+03</td>
<td>7.723248e+03</td>
<td>6.886463e+03</td>
<td>2.049665e+03</td>
<td>7.388189e+03</td>
<td>7.815405e+03</td>
<td>4.409009e+03</td>
</tr>
</tbody>
</table>

<p>6 rows × 142 columns</p>
</div>
</div>
</div>
</section>
<section id="summary-of-common-reshaping-functions" class="level4" data-number="12.0.1.9">
<h4 data-number="12.0.1.9" class="anchored" data-anchor-id="summary-of-common-reshaping-functions"><span class="header-section-number">12.0.1.9</span> Summary of Common Reshaping Functions:</h4>
<table class="table">
<colgroup>
<col style="width: 13%">
<col style="width: 53%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pivot()</code></td>
<td>Reshape data by creating new columns from existing ones.</td>
<td>Pivot data on index/columns.</td>
</tr>
<tr class="even">
<td><code>melt()</code></td>
<td>Unpivot data, turning columns into rows.</td>
<td>Convert wide format to long.</td>
</tr>
<tr class="odd">
<td><code>stack()</code></td>
<td>Convert columns to rows.</td>
<td>Move column data to rows.</td>
</tr>
<tr class="even">
<td><code>unstack()</code></td>
<td>Convert rows back to columns.</td>
<td>Move row data to columns.</td>
</tr>
<tr class="odd">
<td><code>.T</code></td>
<td>Transpose the DataFrame (swap rows and columns).</td>
<td>Transpose the entire DataFrame.</td>
</tr>
</tbody>
</table>
</section>
<section id="practical-use-cases" class="level4" data-number="12.0.1.10">
<h4 data-number="12.0.1.10" class="anchored" data-anchor-id="practical-use-cases"><span class="header-section-number">12.0.1.10</span> Practical Use Cases:</h4>
<ul>
<li><strong>Pivoting:</strong> Useful for time series analysis or when you want to group and summarize data by specific categories.</li>
<li><strong>Melting:</strong> Helpful when you need to reshape wide data for easier analysis or when preparing data for machine learning algorithms.</li>
<li><strong>Stacking/Unstacking:</strong> Useful when you are working with hierarchical index DataFrames.</li>
<li><strong>Transpose:</strong> Helpful for reorienting data for analysis or visualization.</li>
</ul>
</section>
<section id="converting-from-multi-level-index-to-single-level-index-dataframe" class="level4" data-number="12.0.1.11">
<h4 data-number="12.0.1.11" class="anchored" data-anchor-id="converting-from-multi-level-index-to-single-level-index-dataframe"><span class="header-section-number">12.0.1.11</span> Converting from Multi-Level Index to Single-Level Index DataFrame</h4>
<p>If you’re uncomfortable working with DataFrames that have multi-level indexes and columns, you can convert them into single-level DataFrames using the methods you learned in the previous chapter:</p>
<ul>
<li><code>reset_index()</code></li>
<li>Flattening the multi-level columns</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reset the index to convert the multi-level index to a single-level index</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">country</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">lifeExp</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">pop</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">gdpPercap</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Africa</td>
<td>Algeria</td>
<td>59.030167</td>
<td>10.340069</td>
<td>1.987541e+07</td>
<td>8.613355e+06</td>
<td>4426.025973</td>
<td>1310.337656</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Africa</td>
<td>Angola</td>
<td>37.883500</td>
<td>4.005276</td>
<td>7.309390e+06</td>
<td>2.672281e+06</td>
<td>3607.100529</td>
<td>1165.900251</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Africa</td>
<td>Benin</td>
<td>48.779917</td>
<td>6.128681</td>
<td>4.017497e+06</td>
<td>2.105002e+06</td>
<td>1155.395107</td>
<td>159.741306</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Africa</td>
<td>Botswana</td>
<td>54.597500</td>
<td>5.929476</td>
<td>9.711862e+05</td>
<td>4.710965e+05</td>
<td>5031.503557</td>
<td>4178.136987</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Africa</td>
<td>Burkina Faso</td>
<td>44.694000</td>
<td>6.845792</td>
<td>7.548677e+06</td>
<td>3.247808e+06</td>
<td>843.990665</td>
<td>183.430087</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">137</td>
<td>Europe</td>
<td>Switzerland</td>
<td>75.565083</td>
<td>4.011572</td>
<td>6.384293e+06</td>
<td>8.582009e+05</td>
<td>27074.334405</td>
<td>6886.463308</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">138</td>
<td>Europe</td>
<td>Turkey</td>
<td>59.696417</td>
<td>9.030591</td>
<td>4.590901e+07</td>
<td>1.667768e+07</td>
<td>4469.453380</td>
<td>2049.665102</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">139</td>
<td>Europe</td>
<td>United Kingdom</td>
<td>73.922583</td>
<td>3.378943</td>
<td>5.608780e+07</td>
<td>3.174339e+06</td>
<td>19380.472986</td>
<td>7388.189399</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">140</td>
<td>Oceania</td>
<td>Australia</td>
<td>74.662917</td>
<td>4.147774</td>
<td>1.464931e+07</td>
<td>3.915203e+06</td>
<td>19980.595634</td>
<td>7815.405220</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">141</td>
<td>Oceania</td>
<td>New Zealand</td>
<td>73.989500</td>
<td>3.559724</td>
<td>3.100032e+06</td>
<td>6.547108e+05</td>
<td>17262.622813</td>
<td>4409.009167</td>
</tr>
</tbody>
</table>

<p>142 rows × 8 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># flatten the multi-level column</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data.columns <span class="op">=</span> [<span class="st">'_'</span>.join(col).strip() <span class="cf">for</span> col <span class="kw">in</span> gdp_lifeExp_multilevel_data.columns.values]</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>gdp_lifeExp_multilevel_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">lifeExp_mean</th>
<th data-quarto-table-cell-role="th">lifeExp_std</th>
<th data-quarto-table-cell-role="th">pop_mean</th>
<th data-quarto-table-cell-role="th">pop_std</th>
<th data-quarto-table-cell-role="th">gdpPercap_mean</th>
<th data-quarto-table-cell-role="th">gdpPercap_std</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">continent</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Africa</td>
<td data-quarto-table-cell-role="th">Algeria</td>
<td>59.030167</td>
<td>10.340069</td>
<td>1.987541e+07</td>
<td>8.613355e+06</td>
<td>4426.025973</td>
<td>1310.337656</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Angola</td>
<td>37.883500</td>
<td>4.005276</td>
<td>7.309390e+06</td>
<td>2.672281e+06</td>
<td>3607.100529</td>
<td>1165.900251</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Benin</td>
<td>48.779917</td>
<td>6.128681</td>
<td>4.017497e+06</td>
<td>2.105002e+06</td>
<td>1155.395107</td>
<td>159.741306</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Botswana</td>
<td>54.597500</td>
<td>5.929476</td>
<td>9.711862e+05</td>
<td>4.710965e+05</td>
<td>5031.503557</td>
<td>4178.136987</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Burkina Faso</td>
<td>44.694000</td>
<td>6.845792</td>
<td>7.548677e+06</td>
<td>3.247808e+06</td>
<td>843.990665</td>
<td>183.430087</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">Europe</td>
<td data-quarto-table-cell-role="th">Switzerland</td>
<td>75.565083</td>
<td>4.011572</td>
<td>6.384293e+06</td>
<td>8.582009e+05</td>
<td>27074.334405</td>
<td>6886.463308</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Turkey</td>
<td>59.696417</td>
<td>9.030591</td>
<td>4.590901e+07</td>
<td>1.667768e+07</td>
<td>4469.453380</td>
<td>2049.665102</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">United Kingdom</td>
<td>73.922583</td>
<td>3.378943</td>
<td>5.608780e+07</td>
<td>3.174339e+06</td>
<td>19380.472986</td>
<td>7388.189399</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Oceania</td>
<td data-quarto-table-cell-role="th">Australia</td>
<td>74.662917</td>
<td>4.147774</td>
<td>1.464931e+07</td>
<td>3.915203e+06</td>
<td>19980.595634</td>
<td>7815.405220</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">New Zealand</td>
<td>73.989500</td>
<td>3.559724</td>
<td>3.100032e+06</td>
<td>6.547108e+05</td>
<td>17262.622813</td>
<td>4409.009167</td>
</tr>
</tbody>
</table>

<p>142 rows × 6 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="data-enriching" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="data-enriching"><span class="header-section-number">12.1</span> Data Enriching</h2>
<p>Data enriching involves enhancing your existing dataset by adding additional data, often from external sources, to make your dataset more insightful.</p>
<section id="common-methods-for-data-enriching" class="level3" data-number="12.1.1">
<h3 data-number="12.1.1" class="anchored" data-anchor-id="common-methods-for-data-enriching"><span class="header-section-number">12.1.1</span> Common Methods for Data Enriching</h3>
<ul>
<li><strong>Merging using <code>merge()</code></strong>: Combining datasets based on a common key.</li>
<li><strong>Joining using <code>join()</code></strong>: Using indices to combine data.</li>
<li><strong>Concatenation using <code>concat()</code></strong>: Stacking DataFrames vertically or horizontally.</li>
</ul>
<p>Let’s first load the existing data</p>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df_existing <span class="op">=</span> pd.read_csv(<span class="st">'./datasets/LOTR.csv'</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_existing.shape)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>df_existing.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(4, 3)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="87">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FellowshipID</th>
<th data-quarto-table-cell-role="th">FirstName</th>
<th data-quarto-table-cell-role="th">Skills</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1001</td>
<td>Frodo</td>
<td>Hiding</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1002</td>
<td>Samwise</td>
<td>Gardening</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1003</td>
<td>Gandalf</td>
<td>Spells</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1004</td>
<td>Pippin</td>
<td>Fireworks</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Let’s next load the external data we want to combine to the existing data</p>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df_external <span class="op">=</span> pd.read_csv(<span class="st">"./datasets/LOTR 2.csv"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_external.shape)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>df_external.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(5, 3)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="88">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FellowshipID</th>
<th data-quarto-table-cell-role="th">FirstName</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1001</td>
<td>Frodo</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1002</td>
<td>Samwise</td>
<td>39</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1006</td>
<td>Legolas</td>
<td>2931</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1007</td>
<td>Elrond</td>
<td>6520</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1008</td>
<td>Barromir</td>
<td>51</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="combining-based-on-common-keys-merge" class="level3" data-number="12.1.2">
<h3 data-number="12.1.2" class="anchored" data-anchor-id="combining-based-on-common-keys-merge"><span class="header-section-number">12.1.2</span> Combining based on common keys: <code>merge()</code></h3>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>df_enriched_merge <span class="op">=</span> pd.merge(df_existing, df_external)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_enriched_merge.shape)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>df_enriched_merge.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(2, 4)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="89">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FellowshipID</th>
<th data-quarto-table-cell-role="th">FirstName</th>
<th data-quarto-table-cell-role="th">Skills</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1001</td>
<td>Frodo</td>
<td>Hiding</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1002</td>
<td>Samwise</td>
<td>Gardening</td>
<td>39</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>You can also do this way</p>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>df_enriched_merge <span class="op">=</span> df_existing.merge(df_external)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_enriched_merge.shape)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>df_enriched_merge.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(2, 4)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="90">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FellowshipID</th>
<th data-quarto-table-cell-role="th">FirstName</th>
<th data-quarto-table-cell-role="th">Skills</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1001</td>
<td>Frodo</td>
<td>Hiding</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1002</td>
<td>Samwise</td>
<td>Gardening</td>
<td>39</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>By default, the <code>merge()</code> function in pandas performs an <strong>inner join</strong>, which combines two DataFrames based on the <strong>common keys shared by both</strong>. Only the rows with matching keys in both DataFrames are retained in the result.</p>
<p>This behavior can be observed in the following code:</p>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df_enriched_merge <span class="op">=</span> pd.merge(df_existing, df_external, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_enriched_merge.shape)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>df_enriched_merge.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(2, 4)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="91">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FellowshipID</th>
<th data-quarto-table-cell-role="th">FirstName</th>
<th data-quarto-table-cell-role="th">Skills</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1001</td>
<td>Frodo</td>
<td>Hiding</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1002</td>
<td>Samwise</td>
<td>Gardening</td>
<td>39</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>When you may use inner join?</strong> You should use inner join when you cannot carry out the analysis unless the observation corresponding to the <em>key column(s)</em> is present in both the tables.</p>
<p><strong>Example:</strong> Suppose you wish to analyze the association between vaccinations and covid infection rate based on country-level data. In one of the datasets, you have the infection rate for each country, while in the other one you have the number of vaccinations in each country. The countries which have either the vaccination or the infection rate missing, cannot help analyze the association. In such as case you may be interested only in countries that have values for both the variables. Thus, you will use inner join to discard the countries with either value missing.</p>
<p>In <code>merge()</code>, the <code>how</code> parameter specifies the type of merge to be performed, the default option is <code>inner</code>, it could also be <code>left</code>, <code>right</code>, and <code>outer</code>.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:752/0*ZGDgg-0SznYlwiij.png" alt="Description" width="400px"></p>
<p>These join types give you flexibility in how you want to merge and combine data from different sources.</p>
<p>Let’s see how each of these works using our dataframes defined above</p>
<p><strong>Left Join</strong></p>
<ul>
<li>Returns all rows from the left DataFrame and the matching rows from the right DataFrame.</li>
<li>Missing values (<code>NaN</code>) are introduced for non-matching keys from the right DataFrame.</li>
</ul>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>df_merge_lft <span class="op">=</span> pd.merge(df_existing, df_external, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_merge_lft.shape)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>df_merge_lft.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(4, 4)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="92">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FellowshipID</th>
<th data-quarto-table-cell-role="th">FirstName</th>
<th data-quarto-table-cell-role="th">Skills</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1001</td>
<td>Frodo</td>
<td>Hiding</td>
<td>50.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1002</td>
<td>Samwise</td>
<td>Gardening</td>
<td>39.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1003</td>
<td>Gandalf</td>
<td>Spells</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1004</td>
<td>Pippin</td>
<td>Fireworks</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>When you may use left join?</strong> You should use left join when the primary variable(s) of interest are present in the one of the datasets, and whose missing values cannot be imputed. The variable(s) in the other dataset may not be as important or it may be possible to reasonably impute their values, if missing corresponding to the observation in the primary dataset.</p>
<p><strong>Examples:</strong></p>
<ol type="1">
<li><p>Suppose you wish to analyze the association between the covid infection rate and the government effectiveness score (a metric used to determine the effectiveness of the government in implementing policies, upholding law and order etc.) based on the data of all countries. Let us say that one of the datasets contains the covid infection rate, while the other one contains the government effectiveness score for each country. If the infection rate for a country is missing, it might be hard to impute. However, the government effectiveness score may be easier to impute based on GDP per capita, crime rate etc. - information that is easily available online. In such a case, you may wish to use a left join where you keep all the countries for which the infection rate is known.</p></li>
<li><p>Suppose you wish to analyze the association between demographics such as age, income etc. and the amount of credit card spend. Let us say one of the datasets contains the demographic information of each customer, while the other one contains the credit card spend for the customers who made at least one purchase. In such as case, you may want to do a left join as customers not making any purchase might be absent in the card spend data. Their spend can be imputed as zero after merging the datasets.</p></li>
</ol>
<p><strong>Right join</strong></p>
<ul>
<li>Returns all rows from the right DataFrame and the matching rows from the left DataFrame.</li>
<li>Missing values (<code>NaN</code>) are introduced for non-matching keys from the left DataFrame.</li>
</ul>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df_merge_right <span class="op">=</span> pd.merge(df_existing, df_external, how<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_merge_right.shape)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>df_merge_right.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(5, 4)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="93">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FellowshipID</th>
<th data-quarto-table-cell-role="th">FirstName</th>
<th data-quarto-table-cell-role="th">Skills</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1001</td>
<td>Frodo</td>
<td>Hiding</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1002</td>
<td>Samwise</td>
<td>Gardening</td>
<td>39</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1006</td>
<td>Legolas</td>
<td>NaN</td>
<td>2931</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1007</td>
<td>Elrond</td>
<td>NaN</td>
<td>6520</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1008</td>
<td>Barromir</td>
<td>NaN</td>
<td>51</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>When you may use right join?</strong> You can always use a left join instead of a right join. Their purpose is the same.</p>
<section id="outer-join" class="level4" data-number="12.1.2.1">
<h4 data-number="12.1.2.1" class="anchored" data-anchor-id="outer-join"><span class="header-section-number">12.1.2.1</span> outer join</h4>
<ul>
<li>Returns all rows from both DataFrames, with <code>NaN</code> values where no match is found.</li>
</ul>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>df_merge_outer <span class="op">=</span> pd.merge(df_existing, df_external, how<span class="op">=</span><span class="st">'outer'</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_merge_outer.shape)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>df_merge_outer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(7, 4)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="94">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FellowshipID</th>
<th data-quarto-table-cell-role="th">FirstName</th>
<th data-quarto-table-cell-role="th">Skills</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1001</td>
<td>Frodo</td>
<td>Hiding</td>
<td>50.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1002</td>
<td>Samwise</td>
<td>Gardening</td>
<td>39.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1003</td>
<td>Gandalf</td>
<td>Spells</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1004</td>
<td>Pippin</td>
<td>Fireworks</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1006</td>
<td>Legolas</td>
<td>NaN</td>
<td>2931.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1007</td>
<td>Elrond</td>
<td>NaN</td>
<td>6520.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>1008</td>
<td>Barromir</td>
<td>NaN</td>
<td>51.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>When you may use outer join?</strong> You should use an outer join when you cannot afford to lose data present in either of the tables. All the other joins may result in loss of data.</p>
<p><strong>Example:</strong> Suppose I took two course surveys for this course. If I need to analyze student sentiment during the course, I will take an outer join of both the surveys. Assume that each survey is a dataset, where each row corresponds to a unique student. Even if a student has answered one of the two surverys, it will be indicative of the sentiment, and will be useful to keep in the merged dataset.</p>
</section>
</section>
<section id="combining-based-on-indices-join" class="level3" data-number="12.1.3">
<h3 data-number="12.1.3" class="anchored" data-anchor-id="combining-based-on-indices-join"><span class="header-section-number">12.1.3</span> <strong>Combining Based on Indices: <code>join()</code></strong></h3>
<p>Unlike <code>merge()</code>, <code>join()</code> in pandas combines data based on the <strong>index</strong>. When using <code>join()</code>, you must specify the <code>suffixes</code> parameter if there are overlapping column names, as it does not have default values. You can refer to the official function definition here: <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.join.html">pandas.DataFrame.join</a>.</p>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df_enriched_join <span class="op">=</span> df_existing.join(df_external)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_enriched_join.shape)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>df_enriched_join.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: columns overlap but no suffix specified: Index(['FellowshipID', 'FirstName'], dtype='object')</code></pre>
</div>
</div>
<p>Let’s set the suffix to fix this issue</p>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>df_enriched_join <span class="op">=</span> df_existing.join(df_external, lsuffix <span class="op">=</span> <span class="st">'_existing'</span>,rsuffix <span class="op">=</span> <span class="st">'_external'</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_enriched_join.shape)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>df_enriched_join.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(4, 6)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="96">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FellowshipID_existing</th>
<th data-quarto-table-cell-role="th">FirstName_existing</th>
<th data-quarto-table-cell-role="th">Skills</th>
<th data-quarto-table-cell-role="th">FellowshipID_external</th>
<th data-quarto-table-cell-role="th">FirstName_external</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1001</td>
<td>Frodo</td>
<td>Hiding</td>
<td>1001</td>
<td>Frodo</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1002</td>
<td>Samwise</td>
<td>Gardening</td>
<td>1002</td>
<td>Samwise</td>
<td>39</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1003</td>
<td>Gandalf</td>
<td>Spells</td>
<td>1006</td>
<td>Legolas</td>
<td>2931</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1004</td>
<td>Pippin</td>
<td>Fireworks</td>
<td>1007</td>
<td>Elrond</td>
<td>6520</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As can be observed, <strong><code>join()</code> merges DataFrames using their index and performs a left join</strong>.</p>
<p>Now, let’s set the “FellowshipID” column as the index in both DataFrames and see what happens.</p>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set the index of the dataframes as the "FellowshipID" column</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>df_existing.set_index(<span class="st">'FellowshipID'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>df_external.set_index(<span class="st">'FellowshipID'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># join the two dataframes</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>df_enriched_join <span class="op">=</span> df_existing.join(df_external, lsuffix <span class="op">=</span> <span class="st">'_existing'</span>,rsuffix <span class="op">=</span> <span class="st">'_external'</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_enriched_join.shape)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>df_enriched_join</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(4, 4)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="98">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FirstName_existing</th>
<th data-quarto-table-cell-role="th">Skills</th>
<th data-quarto-table-cell-role="th">FirstName_external</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FellowshipID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1001</td>
<td>Frodo</td>
<td>Hiding</td>
<td>Frodo</td>
<td>50.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1002</td>
<td>Samwise</td>
<td>Gardening</td>
<td>Samwise</td>
<td>39.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1003</td>
<td>Gandalf</td>
<td>Spells</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1004</td>
<td>Pippin</td>
<td>Fireworks</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In this case, <code>df_enriched_join</code> will contain all rows from <code>df_existing</code> and the corresponding matching rows from <code>df_external</code>, with <code>NaN</code> values for non-matching entries.</p>
<p>Similar to <code>merge()</code>, you can change the type of join in <code>join()</code> by explicitly specifying the <code>how</code> parameter. However, this explanation will be skipped here, as the different join types have already been covered in the <code>merge()</code> section above.</p>
</section>
<section id="stacking-dataframes-vertically-or-horizontally-concat" class="level3" data-number="12.1.4">
<h3 data-number="12.1.4" class="anchored" data-anchor-id="stacking-dataframes-vertically-or-horizontally-concat"><span class="header-section-number">12.1.4</span> Stacking DataFrames vertically or horizontally: <code>concat()</code></h3>
<p><code>concat()</code> is used in pandas to concatenate DataFrames along a specified axis, either rows or columns. Similar to <code>concat()</code> in NumPy, it defaults to concatenating along the rows.</p>
<div class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let's concatenate the two dataframes using default setting</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>df_concat <span class="op">=</span> pd.concat([df_existing, df_external])</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_concat.shape)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>df_concat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(9, 3)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="99">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FirstName</th>
<th data-quarto-table-cell-role="th">Skills</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FellowshipID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1001</td>
<td>Frodo</td>
<td>Hiding</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1002</td>
<td>Samwise</td>
<td>Gardening</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1003</td>
<td>Gandalf</td>
<td>Spells</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1004</td>
<td>Pippin</td>
<td>Fireworks</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1001</td>
<td>Frodo</td>
<td>NaN</td>
<td>50.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1002</td>
<td>Samwise</td>
<td>NaN</td>
<td>39.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1006</td>
<td>Legolas</td>
<td>NaN</td>
<td>2931.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1007</td>
<td>Elrond</td>
<td>NaN</td>
<td>6520.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1008</td>
<td>Barromir</td>
<td>NaN</td>
<td>51.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenating along columns (horizontal)</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>df_concat_columns <span class="op">=</span> pd.concat([df_existing, df_external], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_concat_columns.shape)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>df_concat_columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(7, 4)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="100">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FirstName</th>
<th data-quarto-table-cell-role="th">Skills</th>
<th data-quarto-table-cell-role="th">FirstName</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FellowshipID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1001</td>
<td>Frodo</td>
<td>Hiding</td>
<td>Frodo</td>
<td>50.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1002</td>
<td>Samwise</td>
<td>Gardening</td>
<td>Samwise</td>
<td>39.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1003</td>
<td>Gandalf</td>
<td>Spells</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1004</td>
<td>Pippin</td>
<td>Fireworks</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1006</td>
<td>NaN</td>
<td>NaN</td>
<td>Legolas</td>
<td>2931.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1007</td>
<td>NaN</td>
<td>NaN</td>
<td>Elrond</td>
<td>6520.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1008</td>
<td>NaN</td>
<td>NaN</td>
<td>Barromir</td>
<td>51.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="missing-values-after-data-enriching" class="level3" data-number="12.1.5">
<h3 data-number="12.1.5" class="anchored" data-anchor-id="missing-values-after-data-enriching"><span class="header-section-number">12.1.5</span> Missing values after data enriching</h3>
<p>Using either of the approaches mentioned above may introduce missing values for unmatched entries. Handling these missing values is crucial for maintaining the quality and integrity of your dataset after merging or joining DataFrames. It is important to choose a method that best fits your data and analysis goals, and to document your decisions regarding missing value handling for transparency in your analysis.</p>
<p><strong>Question</strong>: Read the documentations of the Pandas DataFrame methods <code>merge()</code> and <code>concat()</code>, and identify the differences. Mention examples when you can use (i) either, (ii) only <code>concat()</code>, (iii) only <code>merge()</code></p>
<p><strong>Solution:</strong></p>
<ol type="i">
<li><p>If we need to merge datasets using row indices, we can use either function.</p></li>
<li><p>If we need to stack datasets one on top of the other, we can only use <code>concat()</code></p></li>
<li><p>If we need to merge datasets using overlapping columns we can only use <code>merge()</code></p></li>
</ol>
</section>
</section>
<section id="independent-practice-1" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="independent-practice-1"><span class="header-section-number">12.2</span> Independent Practice 1</h2>
<p>You are given the life expectancy data of each continent as a separate *.csv file.</p>
<section id="section" class="level3" data-number="12.2.1">
<h3 data-number="12.2.1" class="anchored" data-anchor-id="section"><span class="header-section-number">12.2.1</span> </h3>
<p>Visualize the change of life expectancy over time for different continents.</p>
</section>
<section id="section-1" class="level3" data-number="12.2.2">
<h3 data-number="12.2.2" class="anchored" data-anchor-id="section-1"><span class="header-section-number">12.2.2</span> </h3>
<p>Appending all the data files, i.e., stacking them on top of each other to form a combined datasets called “data_all_continents”</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Data aggregation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data Grouping and Aggregation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Assignment A.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Assignment A</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>